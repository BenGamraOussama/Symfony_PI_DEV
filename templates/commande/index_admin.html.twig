{% extends 'base.html.twig' %}

{% block title %}Commande index
{% endblock %}

{% block body %}
	<!-- begin app -->
	<div
		class="app">
		<!-- begin app-wrap -->
		<div
			class="app-wrap">
			<!-- begin pre-loader -->
		 
			<!-- end pre-loader -->
			<!-- begin app-header -->   
			<header></header>
			<!-- end app-header -->
			<!-- begin app-container -->
			<div class="app-container">
				<!-- begin app-nabar -->

				<!-- end app-navbar -->
				<!-- begin app-main -->
					<div
					class="app-main" id="main"> <!-- begin container-fluid -->
					<div
						class="container-fluid">
						<!-- begin row -->
						<div class="row">
							<div
								class="col-md-12 m-b-30">
								<!-- begin page title -->

								<div class="d-block d-lg-flex flex-nowrap align-items-center">
									<div class="page-title mr-4 pr-4 border-right">
										<h1>Activite</h1>
									</div>
									<div class="breadcrumb-bar align-items-center">
										<nav>
											<ol class="breadcrumb p-0 m-b-0">
												<li class="breadcrumb-item">
													<a href="index.html">
														<i class="ti ti-home"></i>
													</a>
												</li>
												<li class="breadcrumb-item">
													Activite
												</li>
												<li class="breadcrumb-item active text-primary" aria-current="page">Default</li>
											</ol>
										</nav>
									</div>
									<!-- end page title -->
								</div>
							</div>
							<!-- Notification -->

							<!-- end row -->
							<!-- begin row -->
								<div class="row"> <div class="container-fluid py-0">
									<div class="row">

										<div class="col-md-10 main-content"><br>
											<br><br>
											<div class="card shadow">


												<div class="card-body">
													<div class="table-responsive">
														<h1>mes commandes</h1>
														<table class="table">
															<thead>
																<tr>
																	<th>Id</th>
																	<th>Client</th>
																	<th>Date_commande</th>
																	<th>Montant_total</th>
																	<th>actions</th>
																</tr>
															</thead>
															<tbody>
																{% for commande in commandes %}
																	<tr>
																		{% set total = 0 %}

																		{% for ligne in commande.lignes %}
																			{% set ligneTotal = ligne.quantite * ligne.prixUnitaire %}
																			{% set total = total + ligneTotal %}

																		{% endfor %}
																		<td>{{ commande.id }}</td>
																		<td>{{ commande.user.lastName }}  {{ commande.user.firstName }}</td>
																		<td>{{ commande.dateCommande ? commande.dateCommande|date('Y-m-d H:i:s') : '' }}</td>
																		<td>
																			{% if total ==0 %}
																				<a class="btn btn-success" href="{{ path('app_commande_add_ligne_de_commande', {'id': commande.id}) }}">Ajouter une Ligne</a>
																			{% else %}
																				{{total}}
																				TND
																			{% endif %}
																		</td>
																		<td>
																			<a class="btn btn-secondary" href="{{ path('app_commande_show_admin', {'id': commande.id}) }}">Consulter</a>
																		</td>
																	</tr>
																{% else %}
																	<tr>
																		<td colspan="4">no records found</td>
																	</tr>
																{% endfor %}						
															</tbody>
														</table>
													</div>
												  <nav class="pagination-container">
    <ul class="pagination">
        {% if commandes.currentPageNumber > 1 %}
            <li>
                <a href="{{ path(app.request.attributes.get('_route'), app.request.query.all|merge({'page': commandes.currentPageNumber - 1})) }}" class="pagination-link prev">« précedent</a>
            </li>
        {% endif %}

        {% for page in commandes.paginationData.pagesInRange %}
            <li class="pagination-item {{ commandes.currentPageNumber == page ? 'active' : '' }}">
                <a href="{{ path(app.request.attributes.get('_route'), app.request.query.all|merge({'page': page})) }}" class="pagination-link">{{ page }}</a>
            </li>
        {% endfor %}

        {% if commandes.currentPageNumber < commandes.paginationData.pageCount %}
            <li>
                <a href="{{ path(app.request.attributes.get('_route'), app.request.query.all|merge({'page': commandes.currentPageNumber + 1})) }}" class="pagination-link next">Suivant »</a>
            </li>
        {% endif %}
    </ul>
</nav>
<style>.pagination-container {
    text-align: center;
    margin-top: 20px;
}

.pagination {
    list-style: none;
    padding: 0;
    display: flex;
    justify-content: center;
    gap: 8px;
}

.pagination-item {
    display: inline-block;
}

.pagination-link {
    display: block;
    padding: 8px 12px;
    text-decoration: none;
    color:rgb(0, 25, 51);
    border: 1px solid rgb(0, 25, 51);
    border-radius: 5px;
    transition: all 0.3s ease-in-out;
}

.pagination-link:hover {
    background-color: rgb(0, 25, 51);
    color: white;
}

.pagination-item.active .pagination-link {
    background-color: rgb(0, 25, 51);
    color: white;
    font-weight: bold;
}

.prev, .next {
    font-weight: bold;
}
</style>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div> <br><br><br>{% endblock %}